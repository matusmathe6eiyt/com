<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rifa Solidária — Participe e Concorra a R$1.000</title>
  <meta name="description" content="Rifa: bilhete R$10 — prêmio R$1.000. São 200 números. Compre pelo WhatsApp +55 85 9678-7670" />
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#0eb8c0;
      --muted:#aab4c0;
      --green:#22c55e;
      --white:#ffffff;
      --radius:12px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;background:linear-gradient(180deg,#071026,#071834);color:var(--white);display:flex;align-items:center;justify-content:center;padding:24px}
    .container{width:100%;max-width:980px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:16px;padding:28px;box-shadow:0 12px 40px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.04)}
    header{display:flex;align-items:center;gap:16px}
    .logo{width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#06a6a9);display:flex;align-items:center;justify-content:center;font-weight:800;color:#042225;font-size:20px}
    h1{margin:0;font-size:22px}
    p.lead{margin:8px 0 18px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:20px}
    .card{background:rgba(255,255,255,0.02);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .info-row{display:flex;justify-content:space-between;align-items:center;margin:10px 0}
    .big{font-size:20px;font-weight:700}
    .muted{color:var(--muted);font-size:14px}
    label{display:block;font-size:14px;margin-bottom:6px;color:var(--muted)}
    input[type="number"]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--white);font-size:16px}
    .inline{display:flex;gap:8px;align-items:center}
    .btn-wa{display:inline-flex;gap:10px;align-items:center;background:#25D366;border-radius:10px;padding:12px 14px;color:#042225;font-weight:700;border:none;cursor:pointer;text-decoration:none}
    .btn-secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--white);padding:10px 12px;border-radius:8px;cursor:pointer}
    .progress-wrap{background:rgba(255,255,255,0.04);border-radius:10px;padding:8px}
    .progress{background:rgba(0,0,0,0.2);height:18px;border-radius:8px;overflow:hidden}
    .progress .bar{height:100%;width:40%;background:linear-gradient(90deg,var(--green),#16a34a);display:flex;align-items:center;justify-content:center;font-weight:700;color:#042225}
    .stats{display:flex;gap:12px;margin-top:10px;flex-wrap:wrap}
    .stat{background:rgba(255,255,255,0.03);padding:10px;border-radius:8px;min-width:120px;text-align:center}
    .foot{margin-top:14px;font-size:13px;color:var(--muted)}
    .center{display:flex;align-items:center;justify-content:center}
    @media (max-width:880px){
      .grid{grid-template-columns:1fr}
      .btn-wa{width:100%;justify-content:center}
    }
  </style>
</head>
<body>
  <main class="container" role="main" aria-label="Página da rifa">
    <header>
      <div class="logo">RIFA</div>
      <div>
        <h1>Rifa: Ganhe R$1.000 — Bilhete R$10</h1>
        <p class="lead">São <strong id="totalNumbers">200</strong> números. Compre seu bilhete agora pelo WhatsApp e concorra ao prêmio em dinheiro.</p>
      </div>
    </header>

    <section class="grid" aria-labelledby="rifa-info">
      <!-- left -->
      <div>
        <div class="card" id="rifa-info">
          <div class="info-row">
            <div>
              <div class="muted">Valor do bilhete</div>
              <div class="big">R$ <span id="ticketPrice">10</span>,00</div>
            </div>
            <div class="center">
              <div class="muted" style="text-align:right">Prêmio</div>
              <div class="big" style="text-align:right">R$ 1.000,00</div>
            </div>
          </div>

          <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0" />

          <div>
            <label for="quantity">Quantos bilhetes deseja comprar?</label>
            <div class="inline">
              <input id="quantity" type="number" min="1" max="200" value="1" aria-label="Quantidade de bilhetes" />
              <button id="btnCalc" class="btn-secondary" title="Calcular">Calcular</button>
            </div>
            <p class="muted" style="margin-top:8px">Preço total: <strong>R$ <span id="totalPrice">10</span>,00</strong></p>
          </div>

          <div style="margin-top:12px">
            <label class="muted">Seu número preferido (opcional)</label>
            <input id="preferred" type="text" placeholder="Ex.: 045, 123 ..." aria-label="Número preferido (opcional)" />
            <p class="muted" style="font-size:13px;margin-top:6px">Observação: escolha será confirmada pelo organizador (sujeito à disponibilidade).</p>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
            <!-- WhatsApp button opens chat with message -->
            <a id="whatsappBtn" class="btn-wa" href="#" target="_blank" rel="noopener noreferrer">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M20.5 3.5L3.5 21.5" stroke="#042225" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><path d="M19.07 4.93C20.5 6.36 21.28 8.24 21.28 10.2C21.28 14.66 17.36 18.58 12.9 18.58C11.08 18.58 9.4 18.07 8.01 17.17L4.5 18.5 5.83 14.99C4.93 13.6 4.42 11.92 4.42 10.1 4.42 5.64 8.34 1.72 12.8 1.72 14.76 1.72 16.64 2.5 18.07 3.93Z" stroke="#042225" stroke-width="0.6" stroke-linecap="round" stroke-linejoin="round" fill="#25D366"/></svg>
              Comprar pelo WhatsApp
            </a>

            <button id="btnShare" class="btn-secondary" title="Compartilhar">Compartilhar</button>
          </div>

          <p class="foot">Ao clicar em "Comprar pelo WhatsApp" você será direcionado para o aplicativo/website do WhatsApp para confirmar a compra com o responsável. Pagamento e confirmação final são feitas via conversa.</p>
        </div>

        <div style="margin-top:16px" class="card">
          <h3 style="margin:0 0 8px">Regras rápidas</h3>
          <ul style="margin:0 0 0 18px;color:var(--muted)">
            <li>Preço do bilhete: R$10 (cada).</li>
            <li>Prêmio único: R$1.000 para 1 sortudo.</li>
            <li>Total de números: 200 (um número = um bilhete).</li>
            <li>Sorteio será realizado e comprovado (data será informada no grupo/contato).</li>
            <li>Organizador: contato via WhatsApp +55 85 9678-7670.</li>
          </ul>
        </div>
      </div>

      <!-- right panel -->
      <aside class="card" aria-label="Progresso e detalhes">
        <h3 style="margin-top:0">Progresso da rifa</h3>
        <div class="progress-wrap" aria-hidden="false">
          <div class="progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="40" aria-label="Progresso da rifa">
            <div class="bar" id="progressBar" style="width:40%;">40%</div>
          </div>
        </div>

        <div class="stats">
          <div class="stat">
            <div class="muted">Total</div>
            <div class="big"><span id="statTotal">200</span></div>
          </div>
          <div class="stat">
            <div class="muted">Vendidos</div>
            <div class="big"><span id="statSold">80</span></div>
          </div>
          <div class="stat">
            <div class="muted">Restantes</div>
            <div class="big"><span id="statRemain">120</span></div>
          </div>
        </div>

        <div style="margin-top:14px">
          <h4 style="margin:4px 0 8px">Contato</h4>
          <p class="muted" style="margin:0 0 8px">Fale com o organizador pelo WhatsApp:</p>
          <p style="margin:0 0 10px;font-weight:700">+55 85 9678-7670</p>
          <p class="muted" style="font-size:13px;margin-bottom:6px">Instagram / WhatsApp: use para tirar dúvidas e confirmar números.</p>

          <div style="display:flex;gap:8px">
            <a id="waQuick" class="btn-wa" href="#" target="_blank" rel="noopener noreferrer">Abrir WhatsApp</a>
            <button id="btnCopyPhone" class="btn-secondary">Copiar número</button>
          </div>
        </div>

        <p class="muted" style="margin-top:12px;font-size:13px">Dica: envie o número preferido e quantidade na mensagem para agilizar a reserva.</p>
      </aside>
    </section>
  </main>

  <script>
    // Configurações iniciais
    const TOTAL = 200;
    const PRICE = 10; // reais por bilhete
    // Inicial: 40% vendido
    let sold = Math.round(TOTAL * 0.40); // 80
    let progressPercent = Math.round((sold / TOTAL) * 100);

    // Elementos
    const statTotal = document.getElementById('statTotal');
    const statSold = document.getElementById('statSold');
    const statRemain = document.getElementById('statRemain');
    const progressBar = document.getElementById('progressBar');
    const quantityInput = document.getElementById('quantity');
    const totalPriceEl = document.getElementById('totalPrice');
    const whatsappBtn = document.getElementById('whatsappBtn');
    const waQuick = document.getElementById('waQuick');
    const preferredInput = document.getElementById('preferred');
    const btnCalc = document.getElementById('btnCalc');
    const btnCopyPhone = document.getElementById('btnCopyPhone');

    // Phone for WhatsApp link (no symbols). Use international format without '+' or dashes
    const PHONE_NO = '558596787670'; // +55 85 9678-7670 sanitized

    function refreshStats(){
      statTotal.textContent = TOTAL;
      statSold.textContent = sold;
      statRemain.textContent = Math.max(0, TOTAL - sold);
      progressPercent = Math.round((sold / TOTAL) * 100);
      progressBar.style.width = progressPercent + '%';
      progressBar.textContent = progressPercent + '%';
      progressBar.parentElement.setAttribute('aria-valuenow', progressPercent);
    }

    function calcTotal(){
      const q = Number(quantityInput.value) || 1;
      const qty = Math.max(1, Math.min(TOTAL - sold, q)); // can't buy more than remaining
      const total = qty * PRICE;
      totalPriceEl.textContent = total.toFixed(0);
      return {qty, total};
    }

    // Build whatsapp message and open in new tab/window
    function openWhatsApp(qty, preferred){
      const priceTotal = qty * PRICE;
      let text = `Olá, quero comprar ${qty} bilhete(s) da rifa (R$ ${priceTotal.toFixed(0)}).`;
      if(preferred && preferred.trim().length) text += ` Números preferidos: ${preferred.trim()}.`;
      text += ` Meu contato: `;
      // optionally user can append their phone in chat
      const encoded = encodeURIComponent(text);
      const url = `https://wa.me/${PHONE_NO}?text=${encoded}`;
      window.open(url, '_blank');
    }

    // initial render
    refreshStats();
    calcTotal();

    // actions
    btnCalc.addEventListener('click', function(){
      const {qty} = calcTotal();
      // feedback if trying to buy more than remaining
      const remaining = TOTAL - sold;
      if(qty > remaining){
        alert(`Só restam ${remaining} bilhetes disponíveis.`);
        quantityInput.value = remaining;
        calcTotal();
        return;
      }
    });

    // when clicking WhatsApp Comprar
    whatsappBtn.addEventListener('click', function(e){
      e.preventDefault();
      const {qty} = calcTotal();
      const preferred = preferredInput.value;
      const remaining = TOTAL - sold;
      if(qty > remaining){
        alert(`Erro: só restam ${remaining} bilhetes disponíveis.`);
        return;
      }
      // open chat
      openWhatsApp(qty, preferred);
      // opcional: simular que foram vendidos (aumenta a barra localmente)
      // Atualiza vendidos localmente para feedback (não salva em servidor)
      sold += qty;
      if(sold > TOTAL) sold = TOTAL;
      refreshStats();
      // Se quiser persistir entre recargas, poderia usar localStorage (opcional)
    });

    // quick open WA
    waQuick.addEventListener('click', function(e){
      e.preventDefault();
      const msg = encodeURIComponent("Olá, tenho uma dúvida sobre a rifa.");
      const url = `https://wa.me/${PHONE_NO}?text=${msg}`;
      window.open(url, '_blank');
    });

    // copiar número
    btnCopyPhone.addEventListener('click', function(){
      const phone = '+55 85 9678-7670';
      navigator.clipboard?.writeText(phone).then(function(){
        alert('Número copiado: ' + phone);
      }).catch(function(){
        prompt('Copie o número:', phone);
      });
    });

    // permitir Enter para calcular/atualizar
    quantityInput.addEventListener('keydown', function(e){
      if(e.key === 'Enter'){ btnCalc.click(); }
    });

    // recalcular quando muda quantidade
    quantityInput.addEventListener('change', calcTotal);
    quantityInput.addEventListener('input', calcTotal);

    // share button (nativo)
    document.getElementById('btnShare').addEventListener('click', async function(){
      const shareData = {
        title: 'Rifa: Ganhe R$1.000 — bilhete R$10',
        text: 'Participe da rifa: bilhete R$10. Prêmio R$1.000. São 200 números. Compre pelo WhatsApp +55 85 9678-7670',
        url: location.href
      };
      if(navigator.share){
        try { await navigator.share(shareData); }
        catch(err){ alert('Não foi possível compartilhar: ' + err.message); }
      } else {
        // fallback
        prompt('Copie este texto para compartilhar:', shareData.text + ' ' + shareData.url);
      }
    });
  </script>
</body>
</html>
